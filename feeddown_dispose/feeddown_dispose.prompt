请你帮我写一个python脚本完成以下操作：


有公式：
O_lp = (O_data - (1 - fp)O_lpsec)/fp

其误差处理稍微复杂，请你先确认是否正确

sigma_Olp = (1 / f_p) * sqrt[  sigma_D^2  +  (1 - f_p)^2 * sigma_S^2  +  (O_lpsec - O_lp)^2 * sigma_f^2  ]


我们的终极目标就是要算出O_lp

首先你需要读取文件，默认目录在../dataset_merger/Merged/Proton/finalise_[task].csv

注意文件夹下应当有多个task

其结果看起来像是：
centrality,diff_type,diff_bin,pair_type,delta,delta_err,gamma,gamma_err
5.0,DEta,0.5,SS,-0.0012502902295307011,5.9565544920186844e-05,1.9368521149618595e-05,8.311305095611201e-05
5.0,DEta,0.5,OS,-0.00013225944246148978,5.95243493352375e-05,7.706454759360445e-05,8.305101110056883e-05
5.0,DEta,0.5,Del,0.0011180307870692113,8.420927683706936e-05,5.769602644398585e-05,0.00011749574325932015
5.0,DEta,1.5,SS,-0.0004585545724845009,9.83942789134733e-05,4.515117308495691e-05,0.0001372501213031097
...
5.0,Intg,0.5,OS,0.00011608482293668656,5.192863571648228e-05,3.565080841458653e-05,7.244103449009156e-05
5.0,Intg,0.5,Del,0.0010780018327744597,7.354766233263236e-05,7.24388463038412e-06,0.00010260551364067844
...
5.0,SPt,2.5,OS,0.001150215971023631,7.934872204687657e-05,-2.2256292302810742e-05,0.00011057404175176359
5.0,SPt,2.5,Del,0.002283356289097133,0.00011232370270680288,0.0001257643632118979,0.00015657735328399646
...

diff_type包含Intg,SPt，DEta，SPt将有0.5,1.5,2.5三个值，DEta将有0.5,1.5两个值，Intg应当只有0.5一个值

你要针对不同的centrality,diff_type,diff_bin,pair_type操作，

其中，O_data即是这里的delta或者gamma，

另外你要读取文件：../dataset_merger/Merged/Lambda/finalise_[task].csv

这时候要用task 匹配将要读取的文件，如果不存在这个task，给出警告信息后，使用finalise_default.csv

看起来是这样：
centrality,pair_type,delta,delta_err,gamma,gamma_err,resolution
5.0,SS,-0.001038584286804304,8.727679918227397e-05,-0.00020763439742424051,0.00012173466957940491,0.7167759273754678
5.0,OS,0.0006983166375117,8.7401667800645e-05,8.603656920073143e-05,0.00012188402861440378,0.7167759273754678
5.0,Del,0.001736900924316004,0.00012351636008981677,0.00029367096662497196,0.0001722644658914998,0.7167759273754678
15.0,SS,-0.001306066711518224,0.00011416531869271683,-0.000686679053335151,0.00013215953395221916,0.8636234457577199

缺少了diff_type和diff_bin两项，但是没关系，

对于所有的diff_type和diff_bin，都可以取这里相应的delta和gamma，取做O_lpsec

另外你可以硬编码这个数值：
p primary total:    0.8489101154204324 +/- 0.12451480395843792
ap primary total:   0.854837091993265 +/- 0.1336355938419346
二者可以求和除以2，作为f_p


最终你要生成的还是这样的表：

其结果看起来像是：
centrality,diff_type,diff_bin,pair_type,delta,delta_err,gamma,gamma_err
5.0,DEta,0.5,SS,-0.0012502902295307011,5.9565544920186844e-05,1.9368521149618595e-05,8.311305095611201e-05
5.0,DEta,0.5,OS,-0.00013225944246148978,5.95243493352375e-05,7.706454759360445e-05,8.305101110056883e-05
5.0,DEta,0.5,Del,0.0011180307870692113,8.420927683706936e-05,5.769602644398585e-05,0.00011749574325932015
5.0,DEta,1.5,SS,-0.0004585545724845009,9.83942789134733e-05,4.515117308495691e-05,0.0001372501213031097
...
5.0,Intg,0.5,OS,0.00011608482293668656,5.192863571648228e-05,3.565080841458653e-05,7.244103449009156e-05
5.0,Intg,0.5,Del,0.0010780018327744597,7.354766233263236e-05,7.24388463038412e-06,0.00010260551364067844
...
5.0,SPt,2.5,OS,0.001150215971023631,7.934872204687657e-05,-2.2256292302810742e-05,0.00011057404175176359
5.0,SPt,2.5,Del,0.002283356289097133,0.00011232370270680288,0.0001257643632118979,0.00015657735328399646
...

但是此时的delta和gamma已经是被正确处理之后的了即从原来的 O_data --> O_lp

另外请你注意，pair_type有一个是Del，这个事实上只是OS-SS的结果，所以不应该对其做如上的处理，而是在最后直接将算出来的OS和SS相减得到差值即可

对所有的能找到的task都要进行相同的处理

保存路径
./Proton/finalise_feeddown_dispose_[task].csv

你是否还有任何问题？
